with tab1:
    st.header("ğŸ“ Táº¡o ná»™i dung bÃ i Ä‘Äƒng")
    product_name = st.text_input("TÃªn sáº£n pháº©m")
    keywords = st.text_input("Tá»« khÃ³a", "gá»‘m, thá»§ cÃ´ng, má»™c máº¡c, decor")
    platform = st.selectbox("Ná»n táº£ng", ["Facebook", "Instagram", "Threads"])

    mode = st.radio("Cháº¿ Ä‘á»™ Ä‘Äƒng", ["ğŸ“… Tá»± Ä‘á»™ng Ä‘Ãºng giá»", "ğŸ¤– Tá»± Ä‘á»™ng Ä‘Äƒng Ä‘a dáº¡ng má»—i ngÃ y", "ğŸ‘€ Chá» duyá»‡t thá»§ cÃ´ng"])

    if mode == "ğŸ“… Tá»± Ä‘á»™ng Ä‘Ãºng giá»":
        date = st.date_input("ğŸ“… NgÃ y Ä‘Äƒng", datetime.today())
        time = st.time_input("â° Giá» Ä‘Äƒng", datetime.now().time())
        post_time = datetime.combine(date, time)

    elif mode == "ğŸ¤– Tá»± Ä‘á»™ng Ä‘Äƒng Ä‘a dáº¡ng má»—i ngÃ y":
        start_date = st.date_input("ğŸ“… NgÃ y báº¯t Ä‘áº§u", datetime.today())
        end_date = st.date_input("ğŸ“… NgÃ y káº¿t thÃºc", datetime.today() + timedelta(days=7))
        post_time = st.time_input("â° Giá» Ä‘Äƒng má»—i ngÃ y", datetime.now().time())

    if st.button("âœ¨ Xá»­ lÃ½ bÃ i Ä‘Äƒng"):
        if not product_name or not keywords:
            st.warning("âš ï¸ Vui lÃ²ng nháº­p Ä‘á»§ thÃ´ng tin.")

        elif mode == "ğŸ“… Tá»± Ä‘á»™ng Ä‘Ãºng giá»":
            with open("scheduled_posts.csv", "a", encoding="utf-8", newline="") as f:
                writer = csv.writer(f)
                writer.writerow([
                    product_name,
                    keywords,
                    platform,
                    post_time.strftime("%H:%M"),
                    os.getenv("FB_PAGE_TOKEN"),
                    os.getenv("FB_PAGE_ID"),
                    "once"
                ])
            st.success(f"ğŸ“… ÄÃ£ lÃªn lá»‹ch Ä‘Äƒng vÃ o {post_time.strftime('%d/%m/%Y %H:%M')}")

        elif mode == "ğŸ¤– Tá»± Ä‘á»™ng Ä‘Äƒng Ä‘a dáº¡ng má»—i ngÃ y":
            current_day = start_date
            while current_day <= end_date:
                auto_caption = generate_caption(product_name, keywords, platform)
                with open("scheduled_posts.csv", "a", encoding="utf-8", newline="") as f:
                    writer = csv.writer(f)
                    writer.writerow([
                        product_name,
                        keywords,
                        platform,
                        post_time.strftime("%H:%M"),
                        os.getenv("FB_PAGE_TOKEN"),
                        os.getenv("FB_PAGE_ID"),
                        "daily",
                        auto_caption.replace("\n", " ")
                    ])
                current_day += timedelta(days=1)
            st.success(f"ğŸ¤– ÄÃ£ lÃªn lá»‹ch tá»± Ä‘á»™ng táº¡o & Ä‘Äƒng bÃ i tá»« {start_date} Ä‘áº¿n {end_date} lÃºc {post_time.strftime('%H:%M')}")

        else:
            caption = generate_caption(product_name, keywords, platform)
            st.text_area("ğŸ“‹ Ná»™i dung Ä‘á» xuáº¥t", caption, height=150)
            st.session_state.posts.append({
                "id": str(uuid.uuid4())[:8],
                "product": product_name,
                "platform": platform,
                "caption": caption,
                "time": "chá» duyá»‡t",
                "likes": 0, "comments": 0, "shares": 0, "reach": 0
            })
            st.success("âœ… ÄÃ£ lÆ°u bÃ i viáº¿t Ä‘á»ƒ báº¡n duyá»‡t & Ä‘Äƒng sau!")

    if st.session_state.posts:
        st.markdown("### ğŸ“‘ Danh sÃ¡ch bÃ i Ä‘Äƒng chá» duyá»‡t")
        st.dataframe(pd.DataFrame(st.session_state.posts))
    else:
        st.info("ChÆ°a cÃ³ bÃ i viáº¿t nÃ o.")
